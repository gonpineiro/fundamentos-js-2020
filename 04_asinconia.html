<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Asíncronia en JS</title>
    </head>
    <body>
        <h1>Asíncronia en JS</h1>
        <script>
            /* Código Síncrono bloqueante */
            console.log('------Código Síncrono------');
            (() => {
                console.log('Inicio');

                function dos() {
                    console.log('Dos');
                }
                function uno() {
                    console.log('Uno');
                    dos();
                    console.log('Tres');
                }
                uno();
                console.log('Fin');
            })();
            console.log('*******************');
            /* Código Asíncrono No Bloqueante */
            console.log('------Código Asíncrono------ (COMENTADO)');
            /* (() => {
                console.log('Inicio');

                function dos() {
                    setTimeout(() => {
                        console.log('Dos');
                    }, 1000);
                }
                function uno() {
                    setTimeout(() => {
                        console.log('Uno');
                    }, 0);
                    dos();
                    console.log('Tres');
                }
                uno();
                console.log('Fin');
            })(); */

            console.log('------Callbacks------ (COMENTADO)');
            /* function powCallback(value, callback) {
                setTimeout(() => {
                    callback(value, value * value);
                }, 0 | (Math.random() * 1000));
            }
            powCallback(1, (value, result) => {
                console.log(`Inicia Callback`);
                console.log(`Callback: ${value}, ${result}`);
                powCallback(2, (value, result) => {
                    console.log(`Callback: ${value}, ${result}`);
                    powCallback(3, (value, result) => {
                        console.log(`Callback: ${value}, ${result}`);
                        powCallback(4, (value, result) => {
                            console.log(`Callback: ${value}, ${result}`);
                            powCallback(5, (value, result) => {
                                console.log(`Callback: ${value}, ${result}`);
                                console.log('Fin del Callback');
                                console.log('http://callbackhell.com/');
                            });
                        });
                    });
                });
            }); */

            console.log('------Promesas------ (COMENTADO)');
            /* function powPromise(value) {
                if (typeof value !== 'number') return Promise.reject('Error');
                return new Promise((resolve, reject) => {
                    setTimeout(() => {
                        resolve({
                            value,
                            result: value * value,
                        });
                    }, 0 | (Math.random() * 1000));
                });
            }
            powPromise(0)
                .then((obj) => {
                    console.log('Inicio promise');
                    console.log(obj);
                    return powPromise(1);
                })
                .then((obj) => {
                    console.log(obj);
                    return powPromise(2);
                })
                .then((obj) => {
                    console.log(obj);
                    return powPromise(3);
                })
                .then((obj) => {
                    console.log(obj);
                    return powPromise(4);
                })
                .then((obj) => {
                    console.log(obj);
                    return powPromise('5');
                })
                .then((obj) => {
                    console.log(obj);
                })
                .catch((err) => {
                    console.error(err);
                }); */

            console.log('------Async / Await------ (COMENTADO)');
            function powAsync(value) {
                if (typeof value !== 'number') return Promise.reject('Error');
                return new Promise((resolve, reject) => {
                    setTimeout(() => {
                        resolve({
                            value,
                            result: value * value,
                        });
                    }, 0 | (Math.random() * 1000));
                });
            }

            async function asyncFunction(n) {
                try {
                    console.log('Inicio de AsynFunction');
                    let value = await powAsync(n);
                    console.log(`Async Function: ${value.value}, ${value.result}`);
                    value = await powAsync(++n);
                    console.log(`Async Function: ${value.value}, ${value.result}`);
                    value = await powAsync(++n);
                    console.log(`Async Function: ${value.value}, ${value.result}`);
                    value = await powAsync(++n);
                    console.log(`Async Function: ${value.value}, ${value.result}`);
                    value = await powAsync(++n);
                    console.log(`Async Function: ${value.value}, ${value.result}`);
                } catch (error) {
                    console.error(error);
                }
            }
            const asyncFunctionExpres = async (n) => {
                try {
                    console.log('Inicio de AsynFunction');
                    let value = await powAsync(n);
                    console.log(`Async Function: ${value.value}, ${value.result}`);
                    value = await powAsync(++n);
                    console.log(`Async Function: ${value.value}, ${value.result}`);
                    value = await powAsync(++n);
                    console.log(`Async Function: ${value.value}, ${value.result}`);
                    value = await powAsync(++n);
                    console.log(`Async Function: ${value.value}, ${value.result}`);
                    value = await powAsync(++n);
                    console.log(`Async Function: ${value.value}, ${value.result}`);
                } catch (error) {
                    console.error(error);
                }
            };
            asyncFunction('0');
            asyncFunctionExpres(0);
        </script>
    </body>
</html>
